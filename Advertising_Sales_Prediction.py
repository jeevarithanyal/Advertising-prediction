# -*- coding: utf-8 -*-
"""Project.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1QcUQ3ef_66whtFFuF3gMHWPFUfspFLdD

###Import Libraries
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_absolute_error,mean_squared_error,r2_score
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler

"""###Upload Dataset"""

from google.colab import files
uf = files.upload()

"""###Read Dataset"""

df = pd.read_csv('advertising.csv')
df.head()

df.shape

df.info()

df.describe()

"""###Check any NULL Values and Duplicates"""

df.isnull().sum()

df.duplicated().sum()

df.columns

"""###Split Data Training and Testing"""

x = df[['TV', 'Radio', 'Newspaper']]
y = df['Sales']

x_train,x_test,y_train,y_test = train_test_split(x,y,test_size= 0.2,random_state= 42)

x_train.shape

x_test.shape

y_train.shape

y_test.shape

"""###Build Model"""

model =LinearRegression()
model.fit(x_train,y_train)

"""####Predict Sales"""

y_pre = model.predict(x_test)

y_pre

"""###Evaluate the Model"""

mse = mean_squared_error(y_test, y_pre)
r2 = r2_score(y_test, y_pre)

print("Mean Squared Error (MSE):", mse)
print("RÂ² Score:", r2)

"""###Actual Sales vs Predicted Sales"""

plt.scatter(y_test, y_pre)
plt.xlabel("Actual Sales")
plt.ylabel("Predicted Sales")
plt.title("Actual vs Predicted Sales")
plt.grid(True)
plt.show()

"""###Predict Sales for a New Scenario"""

tv_spend = 200
radio_spend = 30
newspaper_spend = 50
new_data = [[tv_spend, radio_spend, newspaper_spend]]
predicted_sales = model.predict(pd.DataFrame(new_data, columns=x.columns))
print("Predicted Sales for the New Scenario:", predicted_sales[0])

"""###User Input and Predict Sales"""

tv_spend = float(input("Enter TV Advertising Spend: "))
radio_spend = float(input("Enter Radio Advertising Spend: "))
newspaper_spend = float(input("Enter Newspaper Advertising Spend: "))

user_data = [[tv_spend, radio_spend, newspaper_spend]]
user_prediction = model.predict(pd.DataFrame(user_data, columns=x.columns))

print("\n Predicted Sales:", user_prediction[0])

plt.figure(figsize=(8, 6))
plt.scatter(y_test, y_pre)
plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'r--', linewidth=2)
plt.xlabel("Actual Sales (y_test)")
plt.ylabel("Predicted Sales (y_pre)")
plt.title("Actual vs Predicted Sales (Linear Regression)")
plt.grid(True)
plt.show()

import joblib
joblib.dump(model, "advertising_model.pkl")